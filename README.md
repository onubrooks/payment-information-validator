# payment-information-validator

A simple NodeJs API that validates credit card information and charge amount. This repository is written in vanilla Javascript and low level NodeJs modules with no external libraries. Here's what you can do with the API:

- Validate credit card details: card number, cvv2, expiration date, email and phone number.
- Authorize requests using the popular HMAC hash algorithm.
- A helper endpoint to get the correct hash to use in the validation step.

## Getting Started

You need to have Node and npm installed on your machine to run this code locally. The latest versions of both are recommended.

## Installation

You can clone this repository using the command below:

`git clone {URL}`

And run the the project like this:

 `npm run start`

## Usage

### Authorization

This API uses a bearer token authorization. To make a successful request, a hash signature. The hash is a HMAC signature of your payload and a private key. For convenience, this can be generated by computing the HMAC hash of the payload you are about to send using the private key: `i-love-node-js`. An endpoint has been provided to assist with this task, make a `POST` request to:

`localhost:5000/api/get-hash`

Ensure to use the exact payload you will use to make the final request.

#### Get Hash Example

```curl
curl --location --request POST 'localhost:5000/api/get-hash' \
--data-raw '{
    "email": "hello@example.org",
    "card_number": "374245455400126",
    "cvv2": "123",
    "expiration_date": "07/2021",
    "phone_number": "08090909090",
    "charge_amount": "5000"
}'

```

#### Get Hash Response

`d29b79b005beb0b1fbc5fa61167fc0d7fa5c0f0b8ef0b3e2db0c52148194368fa53ac655508b55e9fd3afafb48a957122f2dfeb8f8461ca0cdb7e6283575930d`

### Validate Card Details

This is the main endpoint that this API was created for. Make a request as follows to `localhost:5000/api/validate-card`:

```curl
curl --location --request POST 'localhost:5000/api/validate-card' \
--data-raw '{
    "email": "hello@example.org",
    "card_number": "374245455400126",
    "cvv2": "123",
    "expiration_date": "07/2021",
    "phone_number": "08090909090",
    "charge_amount": "5000"
}'

```

#### Validate Details Response

A successful request/response cycle, when all fields satisfy the validation rules, looks like this:

```json
{
    "valid": true,
    "message": "Validation passed successfully"
}
```

#### Validate Details Response Unauthorized

```json
{
    "status": "Unauthorized",
    "message": "Request authentication failed"
}
```

When validation fails, the response is sent in the following format:

```json
{
    "valid": false,
    "message": "Validation failed for some fields",
    "errors": [
        {
            "key": "card_number",
            "valid": false,
            "message": "invalid credit card number"
        },
        {
            "key": "cvv",
            "valid": false,
            "message": "cvv must be 3 or 4 numeric characters long"
        },
        {
            "key": "email",
            "valid": false,
            "message": "email is invalid"
        },
        {
            "key": "phone_number",
            "valid": false,
            "message": "phone number must be 11 numeric characters long or have the international format"
        }
    ]
}
```

Note that all validation errors detected is returned in the `errors` array of the response.

### Validations

These are the validations to expect:

### Errors and Status Codes

These are the expected status codes and their meanings:
